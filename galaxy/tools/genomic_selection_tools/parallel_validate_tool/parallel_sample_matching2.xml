<tool id="parallel_sample_matching2" name="Parallel Genotype-Phenotype Matching" version="0.1.0">
  <description>genotype and phenotype files</description>
  <code file="find_indiv.py"/>
  <command interpreter="perl"><![CDATA[
$__tool_directory__/validate_v3ap.pl 
\${GALAXY_SLOTS:-12}
$genotype 
$phenotype 
$gidCol 
#set key_variables = ""
#for $index, $item in enumerate($galaxy_repeat_key_variable)
  #if $key_variables == "":
    #set key_variables = str($item.galaxy_key_variable) 
  #else:
    #set key_variables = $key_variables + "," + str($item.galaxy_key_variable)
  #end if
#end for
$key_variables
$phenoRowStart
$sampleMatchingOutput
$genotypeMatrixOutput
]]>
  </command>
  <inputs>
    <param name="genotype" 
           type="data" 
           format="tabular" 
           label="Encoded Genotype Data" 
           help="(required) File must be tab-delimited" />
    <param name="gid" type="select" label="What line from metadata to extract sample names" dynamic_options="get_field_gid_options(genotype)"/>
    <param name="phenotype" 
           type="data" 
           format="tabular" 
           label="Phenotype Data" 
           help="(required) File must be tab-delimited" />
    <param name="gidCol" 
           type="data_column" 
           data_ref="phenotype"
           use_header_names="true" 
           label="Column Header for GID in the Phenotype File" 
           help="(required) Select the column header which contains the GID"
           value="4" />
    <repeat name="galaxy_repeat_key_variable" 
            title="Grouping Factor"
            min="1">
      <param name="galaxy_key_variable" 
             type="data_column"
             data_ref="phenotype"
             use_header_names="true" 
             label="Column Header for a Grouping Factor in the Phenotype File"
             help="(required) Select a column header for the grouping factor" />
    </repeat>
    <param name="phenoRowStart" 
           type="integer"
           size="4" 
           label="Row Start Number for the Observations in the Phenotype File" 
           help="(required) Select the row number where the observations start"
           value="2" />
  </inputs>
  <outputs>
    <data name="genotypeMatrixOutput" 
          format="tabular" 
          label="Genotype Matrix Output" />
    <data name="sampleMatchingOutput" 
          format="tabular" 
          label="Sample Matching Output" />
  </outputs>
  <tests>
    <test>
      <param name="genotype" 
             value="2018.05.21-genotype.Umesh.hmp" />
      <param name="phenotype" 
             value="2018.05.2018.05.17-phenotype.Umesh.tab" />
      <param name="gidCol" 
             value="5" />
      <repeat names="galaxy_repeat_key_variable">
        <param name="galaxy_key_variable" 
               value="3" /> 
      </repeat>
      <repeat names="galaxy_repeat_key_variable">
        <param name="galaxy_key_variable" 
               value="4" /> 
      </repeat>
      <param name="phenoRowStart" 
             value="2" />
      <output name="outputHapmap" 
              file="validateHmp" />
      <output name="output" 
              file="validateOut" />
    </test>
  </tests>
  <help><![CDATA[
.. class:: infomark

Parallel Genotype-Phenotype Matching       


-----

**Input:**

This tool accepts phenotype and genotype files. The phenotype in tab delimited format while the genotype in GOBII hapmap format.

.. class:: warningmark

**Remember to format your input files like these tables or you'll run into errors.**


- Example Phenotype File:

	+-----------+---------+----------+------------+-------+-------+-------+-------+--------+-------+--------+
	|  planting | country | location | management | entry | BLUP1 | BLUE1 | Mean1 | BLUP2  | BLUE2 | Mean2  |
	+===========+=========+==========+============+=======+=======+=======+=======+========+=======+========+
	| Early     | Mexico  | 1        | 1          | L2    | 7.00  | 32.00 | 86.00 | 34.00  | 43.00 | 43.00  |
	+-----------+---------+----------+------------+-------+-------+-------+-------+--------+-------+--------+
	| Early     | Mexico  | 1        | 1          | L4    | 43.00 | 98.00 | 39.00 | 100.00 | 52.00 | 97.00  |
	+-----------+---------+----------+------------+-------+-------+-------+-------+--------+-------+--------+
	| Early     | Mexico  | 1        | 1          | L6    | 2.00  | 31.00 | 62.00 | 65.00  | 36.00 | 52.00  |
	+-----------+---------+----------+------------+-------+-------+-------+-------+--------+-------+--------+
	| Early     | Mexico  | 1        | 1          | L10   | 55.00 | 9.00  | 75.00 | 73.00  | 10.00 | 11.00  |
	+-----------+---------+----------+------------+-------+-------+-------+-------+--------+-------+--------+
	| Late      | Mexico  | 1        | 2          | L2    | 66.00 | 59.00 | 40.00 | 3.00   | 41.00 | 81.00  |
	+-----------+---------+----------+------------+-------+-------+-------+-------+--------+-------+--------+
	| Late      | Mexico  | 1        | 2          | L4    | 9.00  | 67.00 | 16.00 | 37.00  | 28.00 | 92.00  |
	+-----------+---------+----------+------------+-------+-------+-------+-------+--------+-------+--------+
	| Late      | Mexico  | 1        | 2          | L1    | 29.00 | 94.00 | 56.00 | 68.00  | 69.00 | 18.00  |
	+-----------+---------+----------+------------+-------+-------+-------+-------+--------+-------+--------+
	| Late      | Mexico  | 1        | 2          | L10   | 75.00 | 72.00 | 71.00 | 85.00  | 15.00 | 63.00  |
	+-----------+---------+----------+------------+-------+-------+-------+-------+--------+-------+--------+
	| Early     | India   | 2        | 1          | L2    | 60.00 | 67.00 | 28.00 | 68.00  | 69.00 | 7.00   |
	+-----------+---------+----------+------------+-------+-------+-------+-------+--------+-------+--------+
	| Early     | India   | 2        | 1          | L2    | 14.00 | 22.00 | 48.00 | 65.00  | 72.00 | 68.00  |
	+-----------+---------+----------+------------+-------+-------+-------+-------+--------+-------+--------+
	| Early     | India   | 2        | 1          | L4    | 53.00 | 51.00 | 27.00 | 79.00  | 43.00 | 79.00  |
	+-----------+---------+----------+------------+-------+-------+-------+-------+--------+-------+--------+
	| Early     | India   | 2        | 1          | L6    | 7.00  | 1.00  | 28.00 | 26.00  | 90.00 | 60.00  |
	+-----------+---------+----------+------------+-------+-------+-------+-------+--------+-------+--------+
	| Late      | India   | 2        | 2          | L2    | 84.00 | 66.00 | 14.00 | 61.00  | 98.00 | 89.00  |
	+-----------+---------+----------+------------+-------+-------+-------+-------+--------+-------+--------+
	| Late      | India   | 2        | 2          | L4    | 32.00 | 33.00 | 92.00 | 91.00  | 67.00 | 32.00  |
	+-----------+---------+----------+------------+-------+-------+-------+-------+--------+-------+--------+
	| Late      | India   | 2        | 2          | L6    | 88.00 | 20.00 | 64.00 | 25.00  | 87.00 | 100.00 |
	+-----------+---------+----------+------------+-------+-------+-------+-------+--------+-------+--------+
	| Optimum   | Mexico  | 3        | 3          | L2    | 62.00 | 27.00 | 40.00 | 2.00   | 82.00 | 19.00  |
	+-----------+---------+----------+------------+-------+-------+-------+-------+--------+-------+--------+
	| Optimum   | Mexico  | 3        | 3          | L4    | 75.00 | 20.00 | 43.00 | 28.00  | 83.00 | 70.00  |
	+-----------+---------+----------+------------+-------+-------+-------+-------+--------+-------+--------+
	| Optimum   | Mexico  | 3        | 3          | L6    | 92.00 | 71.00 | 17.00 | 76.00  | 44.00 | 20.00  |
	+-----------+---------+----------+------------+-------+-------+-------+-------+--------+-------+--------+

- Example Encoded Genotype File: 

	The first few lines starting with "#" are metadata lines generated by the GOBII extractor.
	

	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	|  #          |         |       |     |        |            |        |          |           |           | germplasm_name                  | ((CLRCW106/CLWN241)-B)-DH1         | ((CLWN216/CLWN241)-B)-DH118        | ((CLWN216/CLWN345)-B)-DH136        | ((CML552/CLWN241)-B)-DH105         | ((CLWN241/CLWN345)-B)-DH27         | ((CLRCW106/CLWN251)-B)-DH15        | ((CML552/CLWN345)-B)-DH13          | ((CLWN241/CLWN251)-B)-DH52         |
	+=============+=========+=======+=====+========+============+========+==========+===========+===========+=================================+====================================+====================================+====================================+====================================+====================================+====================================+====================================+====================================+
	| #           |         |       |     |        |            |        |          |           |           | germplasm_pedigree              | ((CLRCW106/CLWN241)-B)-DH1         | ((CLWN216/CLWN241)-B)-DH118        | ((CLWN216/CLWN345)-B)-DH136        | ((CML552/CLWN241)-B)-DH105         | ((CLWN241/CLWN345)-B)-DH27         | ((CLRCW106/CLWN251)-B)-DH15        | ((CML552/CLWN345)-B)-DH13          | ((CLWN241/CLWN251)-B)-DH52         |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | germplasm_type                  | DH                                 | DH                                 | DH                                 | DH                                 | DH                                 | DH                                 | DH                                 | DH                                 |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | dnarun_barcode                  |                                    |                                    |                                    |                                    |                                    |                                    |                                    |                                    |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | project_name                    | CL17GSDY                           | CL17GSDY                           | CL17GSDY                           | CL17GSDY                           | CL17GSDY                           | CL17GSDY                           | CL17GSDY                           | CL17GSDY                           |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | project_pi_contact              | Xuecai Zhang                       | Xuecai Zhang                       | Xuecai Zhang                       | Xuecai Zhang                       | Xuecai Zhang                       | Xuecai Zhang                       | Xuecai Zhang                       | Xuecai Zhang                       |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | project_genotyping_purpose      | Genomic Selection                  | Genomic Selection                  | Genomic Selection                  | Genomic Selection                  | Genomic Selection                  | Genomic Selection                  | Genomic Selection                  | Genomic Selection                  |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | project_date_sampled            |                                    |                                    |                                    |                                    |                                    |                                    |                                    |                                    |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | project_division                | GMP                                | GMP                                | GMP                                | GMP                                | GMP                                | GMP                                | GMP                                | GMP                                |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | project_study_name              |                                    |                                    |                                    |                                    |                                    |                                    |                                    |                                    |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | experiment_name                 | CL17GSDY-E01-rAmpSeq               | CL17GSDY-E01-rAmpSeq               | CL17GSDY-E01-rAmpSeq               | CL17GSDY-E01-rAmpSeq               | CL17GSDY-E01-rAmpSeq               | CL17GSDY-E01-rAmpSeq               | CL17GSDY-E01-rAmpSeq               | CL17GSDY-E01-rAmpSeq               |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | vendor_protocol_name            | GDF,_Cornell_University_rAmpSeq    | GDF,_Cornell_University_rAmpSeq    | GDF,_Cornell_University_rAmpSeq    | GDF,_Cornell_University_rAmpSeq    | GDF,_Cornell_University_rAmpSeq    | GDF,_Cornell_University_rAmpSeq    | GDF,_Cornell_University_rAmpSeq    | GDF,_Cornell_University_rAmpSeq    |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | vendor_name                     | GDF, Cornell University            | GDF, Cornell University            | GDF, Cornell University            | GDF, Cornell University            | GDF, Cornell University            | GDF, Cornell University            | GDF, Cornell University            | GDF, Cornell University            |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | protocol_name                   | rAmpSeq                            | rAmpSeq                            | rAmpSeq                            | rAmpSeq                            | rAmpSeq                            | rAmpSeq                            | rAmpSeq                            | rAmpSeq                            |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | dataset_name                    | CL17GSDY-E01-rAmpSeq-D01           | CL17GSDY-E01-rAmpSeq-D01           | CL17GSDY-E01-rAmpSeq-D01           | CL17GSDY-E01-rAmpSeq-D01           | CL17GSDY-E01-rAmpSeq-D01           | CL17GSDY-E01-rAmpSeq-D01           | CL17GSDY-E01-rAmpSeq-D01           | CL17GSDY-E01-rAmpSeq-D01           |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | germplasm_external_code         | L1                                 | L2                                 | L3                                 | L4                                 | L5                                 | L6                                 | L8                                 | L9                                 |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | germplasm_species               | Zea mays subsp. mays               | Zea mays subsp. mays               | Zea mays subsp. mays               | Zea mays subsp. mays               | Zea mays subsp. mays               | Zea mays subsp. mays               | Zea mays subsp. mays               | Zea mays subsp. mays               |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | germplasm_id                    |                                    |                                    |                                    |                                    |                                    |                                    |                                    |                                    |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | germplasm_seed_source_id        | AF14B-5406-1                       | AF14B-5406-228                     | AF14B-5406-435                     | AF14B-5406-659                     | AF14B-5406-866                     | AF14B-5406-1025                    | AF14B-5406-1197                    | AF14B-5406-1371                    |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | germplasm_subsp                 |                                    |                                    |                                    |                                    |                                    |                                    |                                    |                                    |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | germplasm_heterotic_group       |                                    |                                    |                                    |                                    |                                    |                                    |                                    |                                    |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | germplasm_par1                  | CLRCW106                           | CLWN216                            | CLWN216                            | CML552                             | CLWN241                            | CLRCW106                           | CML552                             | CLWN241                            |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | germplasm_par1_type             |                                    |                                    |                                    |                                    |                                    |                                    |                                    |                                    |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | germplasm_par2                  | CLWN241                            | CLWN241                            | CLWN345                            | CLWN241                            | CLWN345                            | CLWN251                            | CLWN345                            | CLWN251                            |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | germplasm_par2_type             |                                    |                                    |                                    |                                    |                                    |                                    |                                    |                                    |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | germplasm_par3                  |                                    |                                    |                                    |                                    |                                    |                                    |                                    |                                    |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | germplasm_par3_type             |                                    |                                    |                                    |                                    |                                    |                                    |                                    |                                    |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | germplasm_par4                  |                                    |                                    |                                    |                                    |                                    |                                    |                                    |                                    |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | germplasm_par4_type             |                                    |                                    |                                    |                                    |                                    |                                    |                                    |                                    |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | dnasample_name                  | CL17GSDY000001                     | CL17GSDY000096                     | CL17GSDY000191                     | CL17GSDY000286                     | CL17GSDY000381                     | CL17GSDY000476                     | CL17GSDY000571                     | CL17GSDY000666                     |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | dnasample_platename             | CL17GSDYMEM1                       | CL17GSDYMEM2                       | CL17GSDYMEM3                       | CL17GSDYMEM4                       | CL17GSDYMEM5                       | CL17GSDYMEM6                       | CL17GSDYMEM7                       | CL17GSDYMEM8                       |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | dnasample_num                   | 138638                             | 138734                             | 138830                             | 138926                             | 139022                             | 139118                             | 139214                             | 139310                             |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | dnasample_well_row              | A                                  | A                                  | A                                  | A                                  | A                                  | A                                  | A                                  | A                                  |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | dnasample_well_col              | 1                                  | 1                                  | 1                                  | 1                                  | 1                                  | 1                                  | 1                                  | 1                                  |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | dnasample_trial_name            |                                    |                                    |                                    |                                    |                                    |                                    |                                    |                                    |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | dnasample_sample_group          |                                    |                                    |                                    |                                    |                                    |                                    |                                    |                                    |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | dnasample_sample_group_cycle    |                                    |                                    |                                    |                                    |                                    |                                    |                                    |                                    |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | dnasample_sample_type           |                                    |                                    |                                    |                                    |                                    |                                    |                                    |                                    |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | dnasample_sample_parent         |                                    |                                    |                                    |                                    |                                    |                                    |                                    |                                    |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| #           |         |       |     |        |            |        |          |           |           | dnasample_ref_sample            |                                    |                                    |                                    |                                    |                                    |                                    |                                    |                                    |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| rs#         | alleles | chrom | pos | strand | assembly#  | center | protLSID | assayLSID | panelLSID | QCcode                          | CL17GSDY000001-CL17GSDYMEM1-A01    | CL17GSDY000096-CL17GSDYMEM2-A01    | CL17GSDY000191-CL17GSDYMEM3-A01    | CL17GSDY000286-CL17GSDYMEM4-A01    | CL17GSDY000381-CL17GSDYMEM5-A01    | CL17GSDY000476-CL17GSDYMEM6-A01    | CL17GSDY000571-CL17GSDYMEM7-A01    | CL17GSDY000666-CL17GSDYMEM8-A01    |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| L9.99050EEE |         |       |     |        |            |        |          |           |           |                                 | 1                                  | 0                                  | 1                                  | 0                                  | 0                                  | 1                                  | 0                                  | 0                                  |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| L9.6B395FB7 |         |       |     |        |            |        |          |           |           |                                 | 0                                  | 0                                  | 0                                  | 0                                  | 0                                  | 0                                  | 0                                  | 0                                  |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| L9.61D72FDF |         |       |     |        |            |        |          |           |           |                                 | 1                                  | 1                                  | 1                                  | 1                                  | 1                                  | 1                                  | 1                                  | 0                                  |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| L9.45322ED4 |         |       |     |        |            |        |          |           |           |                                 | 0                                  | 0                                  | 0                                  | 0                                  | 0                                  | 0                                  | 0                                  | 0                                  |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| L9.E8BCD37D |         |       |     |        |            |        |          |           |           |                                 | 0                                  | 0                                  | 0                                  | 0                                  | 0                                  | 0                                  | 0                                  | 0                                  |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| L9.E7C60970 |         |       |     |        |            |        |          |           |           |                                 | 0                                  | 1                                  | 1                                  | 1                                  | 0                                  | 1                                  | 1                                  | 0                                  |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| L9.A4C11AA4 |         |       |     |        |            |        |          |           |           |                                 | 1                                  | 0                                  | 1                                  | 0                                  | 1                                  | 0                                  | 0                                  | 0                                  |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| L9.9A79AA38 |         |       |     |        |            |        |          |           |           |                                 | 1                                  | 1                                  | 1                                  | 1                                  | 1                                  | 1                                  | 1                                  | 0                                  |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| L9.5D20A3BC |         |       |     |        |            |        |          |           |           |                                 | 1                                  | 0                                  | 1                                  | 0                                  | 1                                  | 0                                  | 0                                  | 0                                  |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
	| L9.9D358A4F |         |       |     |        |            |        |          |           |           |                                 | 1                                  | 1                                  | 1                                  | 1                                  | 1                                  | 1                                  | 1                                  | 0                                  |
	+-------------+---------+-------+-----+--------+------------+--------+----------+-----------+-----------+---------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+

	
**Output:**

This tool produces two tab-delimited files: a genotype file in matrix format and a tabular report file for matches in the phenotype and genotype file.

- Example tabular report

	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	|  is_added  | planting | country | location | management | entry | BLUP1 | BLUE1 | Mean1 | BLUP2 | BLUE2 | Mean2 |
	+============+==========+=========+==========+============+=======+=======+=======+=======+=======+=======+=======+
	| 1          | NA       | NA      | 1        | 1          | L1    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 0          | Early    | Mexico  | 1        | 1          | L2    | 7     | 32    | 86    | 34    | 43    | 43    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 1          | NA       | NA      | 1        | 1          | L3    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 0          | Early    | Mexico  | 1        | 1          | L4    | 43    | 98    | 39    | 100   | 52    | 97    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 1          | NA       | NA      | 1        | 1          | L5    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 0          | Early    | Mexico  | 1        | 1          | L6    | 2     | 31    | 62    | 65    | 36    | 52    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 1          | NA       | NA      | 1        | 1          | L8    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 1          | NA       | NA      | 1        | 1          | L9    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 0          | Late     | Mexico  | 1        | 2          | L1    | 29    | 94    | 56    | 68    | 69    | 18    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 1          | NA       | NA      | 1        | 2          | L2    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 1          | NA       | NA      | 1        | 2          | L3    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 0          | Late     | Mexico  | 1        | 2          | L4    | 9     | 67    | 16    | 37    | 28    | 92    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 1          | NA       | NA      | 1        | 2          | L5    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 1          | NA       | NA      | 1        | 2          | L6    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 1          | NA       | NA      | 1        | 2          | L8    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 1          | NA       | NA      | 1        | 2          | L9    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 1          | NA       | NA      | 2        | 1          | L1    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 0          | Early    | India   | 2        | 1          | L2    | 14    | 22    | 48    | 65    | 72    | 68    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 1          | NA       | NA      | 2        | 1          | L3    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 0          | Early    | India   | 2        | 1          | L4    | 53    | 51    | 27    | 79    | 43    | 79    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 1          | NA       | NA      | 2        | 1          | L5    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 0          | Early    | India   | 2        | 1          | L6    | 7     | 1     | 28    | 26    | 90    | 60    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 1          | NA       | NA      | 2        | 1          | L8    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 1          | NA       | NA      | 2        | 1          | L9    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 1          | NA       | NA      | 2        | 2          | L1    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 1          | NA       | NA      | 2        | 2          | L2    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 1          | NA       | NA      | 2        | 2          | L3    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 0          | Late     | India   | 2        | 2          | L4    | 32    | 33    | 92    | 91    | 67    | 32    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 1          | NA       | NA      | 2        | 2          | L5    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 0          | Late     | India   | 2        | 2          | L6    | 88    | 20    | 64    | 25    | 87    | 100   |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 1          | NA       | NA      | 2        | 2          | L8    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 1          | NA       | NA      | 2        | 2          | L9    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 1          | NA       | NA      | 3        | 3          | L1    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 1          | NA       | NA      | 3        | 3          | L2    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 1          | NA       | NA      | 3        | 3          | L3    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 0          | Optimum  | Mexico  | 3        | 3          | L4    | 75    | 20    | 43    | 28    | 83    | 70    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 1          | NA       | NA      | 3        | 3          | L5    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 0          | Optimum  | Mexico  | 3        | 3          | L6    | 92    | 71    | 17    | 76    | 44    | 20    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 1          | NA       | NA      | 3        | 3          | L8    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+
	| 1          | NA       | NA      | 3        | 3          | L9    | NA    | NA    | NA    | NA    | NA    | NA    |
	+------------+----------+---------+----------+------------+-------+-------+-------+-------+-------+-------+-------+


- Example Genotype matrix: rows are the samples and the columns are the markers

	+---------------------------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+
	|  samples/markers                | L9.99050EEE | L9.6B395FB7 | L9.61D72FDF | L9.45322ED4 | L9.E8BCD37D | L9.E7C60970 | L9.A4C11AA4 | L9.9A79AA38 | L9.5D20A3BC | L9.9D358A4F |
	+=================================+=============+=============+=============+=============+=============+=============+=============+=============+=============+=============+
	| CL17GSDY000001-CL17GSDYMEM1-A01 | 1           | 0           | 1           | 0           | 0           | 0           | 1           | 1           | 1           | 1           |
	+---------------------------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+
	| CL17GSDY000096-CL17GSDYMEM2-A01 | 0           | 0           | 1           | 0           | 0           | 1           | 0           | 1           | 0           | 1           |
	+---------------------------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+
	| CL17GSDY000191-CL17GSDYMEM3-A01 | 1           | 0           | 1           | 0           | 0           | 1           | 1           | 1           | 1           | 1           |
	+---------------------------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+
	| CL17GSDY000286-CL17GSDYMEM4-A01 | 0           | 0           | 1           | 0           | 0           | 1           | 0           | 1           | 0           | 1           |
	+---------------------------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+
	| CL17GSDY000381-CL17GSDYMEM5-A01 | 0           | 0           | 1           | 0           | 0           | 0           | 1           | 1           | 1           | 1           |
	+---------------------------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+
	| CL17GSDY000476-CL17GSDYMEM6-A01 | 1           | 0           | 1           | 0           | 0           | 1           | 0           | 1           | 0           | 1           |
	+---------------------------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+
	| CL17GSDY000571-CL17GSDYMEM7-A01 | 0           | 0           | 1           | 0           | 0           | 1           | 0           | 1           | 0           | 1           |
	+---------------------------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+
	| CL17GSDY000666-CL17GSDYMEM8-A01 | 0           | 0           | 0           | 0           | 0           | 0           | 0           | 0           | 0           | 0           |
	+---------------------------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+

-----

**Author:** Victor Jun M. Ulat

**Email:**  v.ulat@cgiar.org

 
    ]]></help>
</tool>
